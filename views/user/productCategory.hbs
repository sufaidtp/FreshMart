{{> userheader}}
<!-- Main Content -->
<style>
	.src-style {
		border: 1px solid rgb(255, 255, 255);

	}

	.form-searchs {

		border-radius: 30px;
		display: flex;
		align-items: center;
		justify-content: space-around;
		border-radius: 20px;
		border: 1px solid #cacaca;
		height: 34px;
		width: 200px;
	}

	.src-img {
		width: 18px;
		opacity: 40%;
	}

	.btn-new {
		border: none;
		background: #fff;
	}
</style>


<div id="content" class="site-content">
	<!-- Breadcrumb -->
	<div id="breadcrumb">
		<div class="container">

			<h2 class="title">{{catName.[0].name}}</h2>

			<ul class="breadcrumb">
				<li><a href="#" title="Home">Home</a></li>
				<li><a href="#" title="Fruit">{{catName.[0].name}}</a></li>
				{{!-- <li><span>Tomato</span></li> --}}
			</ul>
		</div>
	</div>


	<div class="container">
		<div class="row">
			<!-- Page Content -->
			<div id="center-column" class="col-lg-12 col-md-12">
				<div class="product-category-page">
					<!-- Nav Bar -->
					<div class="products-bar">
						<div class="row">
							<div class="col-md-6 col-xs-6">
								<div class="gridlist-toggle" role="tablist">
									<ul class="nav nav-tabs">
										<li class="active"><a href="#products-grid" data-toggle="tab"
												aria-expanded="true"><i class="fa fa-th-large"></i></a></li>
										<li><a href="#products-list" data-toggle="tab" aria-expanded="false"><i
													class="fa fa-bars"></i></a></li>
									</ul>
								</div>

								<div class="total-products">There are 12 products</div>
							</div>

							<div class="col-md-6 col-xs-6">
								<div class="filter-bar">
									<div class="pull-right">
										<div class="select">
											<select class="form-control" id="category" name="category" form="category"
												onchange="redirectToSort()">
												<option value="">Sort By</option>
												<option value="A - Z">A - Z</option>
												<option value="Z - A">Z - A</option>
												<option value="1-10">Price: Low to High</option>
												<option value="10-1">Price: High to Low</option>
												<!-- <option value="5">In stock</option> -->
											</select>
										</div>
									</div>

									<div class="select">
										<div class="pull-right">

											<form action="/searchProduct" method="post">
												<div class="form-searchs">
													<input type="text" class="form-input src-style" placeholder="Search"
														name="productSearch" value="{{productSearch}}">
													<button type="submit" class="btn-new">
														<img class="src-img"
															src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTGRF6UCc17I4KOC5ShHwlQu80JqFdaKfNaWA&s"
															alt="">
													</button>
												</div>
											</form>

										</div>
									</div>

								</div>
							</div>
						</div>
					</div>

					<div class="tab-content">
						<!-- Products Grid -->
						<div class="tab-pane active" id="products-grid">
							<div class="products-block">

								<div class="row">
									{{#each product}}
									<div class="col-md-3 col-sm-4 col-xs-12">


										<div class="product-item">
											<div class="product-image">
												<a href="/productDetails/{{this._id}}">{{this.name}}
													<img class="img-responsive" src="/{{this.imagePath.[0]}}"
														alt="Product Image">
												</a>
											</div>

											<div class="product-title">
												<a ref="product-detail-left-sidebar.html">
													{{this.name}}
												</a>
											</div>

											<div class="product-rating">
												<div class="star on"></div>
												<div class="star on"></div>
												<div class="star on "></div>
												<div class="star on"></div>
												<div class="star"></div>
											</div>

											<div class="product-price">
												<span class="sale-price">Rs.{{this.discountAmount}}</span>
												<span class="base-price">Rs.{{this.price}}</span>
											</div>

											<div class="product-buttons">
												<a class="add-to-cart" onclick="addToCart('{{this._id}}')">
													<i class="fa fa-shopping-basket" aria-hidden="true"></i>
												</a>

												<a class="add-wishlist" href="/wishlist/{{this._id}}">
													<i class="fa fa-heart" aria-hidden="true"></i>
												</a>

												<a class="quickview" href="/productDetails/{{this._id}}">
													<i class="fa fa-eye" aria-hidden="true"></i>
												</a>
											</div>
										</div>

									</div>
									{{/each}}
								</div>
							</div>
						</div>

						<!-- Products List -->
						<div class="tab-pane" id="products-list">
							<div class="products-block layout-5">
								<div class="product-item">
									{{#each product}}
									<div class="row">

										<div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
											<div class="product-image">
												<a href="/productDetails/{{this._id}}">{{this.name}}
													<img class="img-responsive" src="/{{this.imagePath.[0]}}"
														alt="Product Image">
												</a>
											</div>
										</div>

										<div class="col-lg-9 col-md-9 col-sm-8 col-xs-12">
											<div class="product-info">
												<div class="product-title">
													<a href="product-detail-left-sidebar.html">
														{{this.name}}
													</a>
												</div>

												<div class="product-rating">
													<div class="star on"></div>
													<div class="star on"></div>
													<div class="star on "></div>
													<div class="star on"></div>
													<div class="star"></div>
													<span class="review-count">(3 Reviews)</span>
												</div>

												<div class="product-price">
													<span class="sale-price">Rs.{{this.price}}</span>
													{{!-- <span class="base-price">$90.00</span> --}}
												</div>

												<div class="product-stock">
													<i class="fa fa-check-square-o" aria-hidden="true"></i>In stock
												</div>

												<div class="product-description">
													Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse
													sapien urna, commodo ut molestie vitae, feugiat tincidunt ligula...
												</div>

												<div class="product-buttons">
													<a class="add-to-cart" href="#">
														<i class="fa fa-shopping-basket" aria-hidden="true"></i>
														<span>Add To Cart</span>
													</a>

													<a class="add-wishlist" href="">
														<i class="fa fa-heart" aria-hidden="true"></i>
													</a>

													<a class="quickview" href="#">
														<i class="fa fa-eye" aria-hidden="true"></i>
													</a>
												</div>
											</div>
										</div>
									</div>
									{{/each}}

								</div>

							</div>
						</div>
					</div>

					<!-- Pagination Bar -->
					<div class="pagination-bar">
						<div class="row">
							<div class="col-md-4 col-sm-4 col-xs-12">
								<div class="text">Showing 1-12 of 20 item(s)</div>
							</div>

							<div class="col-md-8 col-sm-8 col-xs-12">
								<div class="pagination">
									<ul class="page-list">
										<li><a href="#" class="prev">Previous</a></li>
										<li><a href="#" class="current">1</a></li>
										<li><a href="#">2</a></li>
										<li><a href="#" class="next">Next</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
	function redirectToSort() {
		const selectedValue =
			document.getElementById("category").value;
		if (selectedValue === "A - Z") {
			window.location.href = "/Ucategory/sort/1"; // Redirect to A -Z sorting page
		} else if (selectedValue === "Z - A") {
			window.location.href = "/Ucategory/sort/2"; // Redirect to Z - A sorting page
		} else if (selectedValue === "1-10") {
			window.location.href = "/Ucategory/sort/3"; // Redirect to Price: Low to High sorting page
		} else if (selectedValue === "10-1") {
			window.location.href = "/Ucategory/sort/4"; // Redirect to Price: High to Low sorting page
		} else {
			// No sorting selected, do nothing
			console.log("dropdown pressed");
		}

	}
</script>
<script>
	function addToCart(id) {
		console.log('addToCart clicked');
		console.log(id);

		// Stringify the id once
		const data = JSON.stringify({ id: id });
		console.log(data);

		fetch('/addtoCart', {
			body: data,
			method: 'post',
			headers: {
				'Content-Type': 'application/json' // Specify the content type
			}
		})
			.then(response => {

				if (!response.ok) {
					throw new Error('Network response was not ok');
				}
				return response.json();


			}).then(data => {
				// Handle the response as needed
				console.log('Response received:', data);
				console.log(data.success)
				if (data.success) {
					Swal.fire({
						// position: "top-end",
						icon: "success",
						title: "Product add to Cart",
						showConfirmButton: false,
						timer: 1500
					});

				} else {
					Swal.fire({
						title: "You are Not Loged in",
						text: "Do you want go Login. Press Login!",
						icon: "warning",
						showCancelButton: true,
						confirmButtonColor: "#3085d6",
						cancelButtonColor: "#d33",
						confirmButtonText: "Login!"
					}).then((result) => {
						if (result.isConfirmed) {
							window.location.href = '/login';
						}
					});


				}
			})
			.catch(error => {
				// Handle any errors
				console.error('Error occurred:', error);
			});
	}

</script>

{{> userfooter}}