<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Dark Bootstrap Admin </title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <!-- Bootstrap CSS-->
  <link rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome CSS-->
  <link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css">
  <!-- Custom Font Icons CSS-->
  <link rel="stylesheet" href="/css/font.css">
  <!-- Google fonts - Muli-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:300,400,700">
  <!-- theme stylesheet-->
  <link rel="stylesheet" href="/css/style.default.css" id="theme-stylesheet">
  <!-- Custom stylesheet - for your changes-->
  <link rel="stylesheet" href="/css/custom.css">
  <!-- Favicon-->
  <link rel="shortcut icon" href="/img/favicon.ico">
  <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  <style>
    .status-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .status-item {
      display: flex;
      justify-content: space-between;
      width: 120px;
      /* Adjust the width as needed */
      align-items: center;
    }
  </style>

</head>

<body>
  {{> adminheader}}
  <div class="d-flex align-items-stretch">
    <!-- Sidebar Navigation-->
    <nav id="sidebar">
      <!-- Sidebar Header-->
      {{!-- <div class="sidebar-header d-flex align-items-center">
        <div class="avatar"><img src="img/avatar-6.jpg" alt="..." class="img-fluid rounded-circle"></div>
        <div class="title">
          <h1 class="h5">Darsan Dinesh</h1>
          <p>Web Designer</p>
        </div>
      </div> --}}
      {{!-- <!-- Sidebar Navidation Menus--><span class="heading">Main</span> --}}
      <ul class="list-unstyled">
        <li class="active"><a href="/admin/dashbord"> <i class="icon-home"></i>Dashboard </a></li>
        <li><a href="/admin/products"> <i class="icon-grid"></i>Products </a></li>
        <li><a href="/admin/userDetails"> <i class="fa fa-bar-chart"></i>Users </a></li>
        <li><a href="/admin/category"> <i class="icon-padnote"></i>Category </a></li>
        <li><a href="/admin/orderHistory"> <i class="icon-padnote"></i>Orders </a></li>
        <li><a href="/admin/coupon"> <i class="icon-padnote"></i>Coupon </a></li>
        {{!-- <li><a href="/admin/offers"> <i class="icon-padnote"></i>Offers </a></li> --}}
      </ul>
    </nav>
    <!-- Sidebar Navigation end-->
    <div class="page-content">
      <div class="page-header" style="display: flex;">
        <div class="container-fluid">
          <h2 class="h5 no-margin-bottom">Dashboard</h2>
        </div>
        <div>
          <div class="dropdown">
            <button class="btn p-0" type="button" id="cardOpt6" data-bs-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              Report
              {{!-- <i class="bx bx-dots-vertical-rounded">Report</i> --}}
            </button>
            <div class="dropdown-menu dropdown-menu-end p-2" aria-labelledby="cardOpt6">
              <h3>Sales Report</h3>
              <form id="reportForm" action="/admin/salesReport" method="post">
                <label for="startDate">Start Date:</label>
                <input type="date" id="startDate" name="startDate" required>

                <label for="endDate">End Date:</label>
                <input type="date" id="endDate" name="endDate" required>

                <label for="reportFormat">Format:</label>
                <select id="reportFormat" name="format">
                  <option value="pdf">PDF</option>
                  <option value="excel">Excel</option>
                </select>

                <button class="btn btn-warning mt-2" type="submit" style="margin-left: 0;">Download Report</button>
              </form>
            </div>
          </div>

        </div>
      </div>

      <section class="no-padding-top no-padding-bottom">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-3 col-sm-6">
              <div class="statistic-block block">
                <div class="progress-details d-flex align-items-end justify-content-between">
                  <div class="title">
                    <div class="icon"><i class="icon-user-1"></i></div><strong>Total Users</strong>
                  </div>
                  <div class="number dashtext-1">{{userCount}}</div>
                </div>
                <div class="progress progress-template">
                  <div role="progressbar" style="width: {{userCount}}%" aria-valuenow="30" aria-valuemin="0"
                    aria-valuemax="100" class="progress-bar progress-bar-template dashbg-1"></div>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-sm-6">
              <div class="statistic-block block">
                <div class="progress-details d-flex align-items-end justify-content-between">
                  <div class="title">
                    <div class="icon"><i class="icon-contract"></i></div><strong>Total Products</strong>
                  </div>
                  <div class="number dashtext-2">{{productCount}}</div>
                </div>
                <div class="progress progress-template">
                  <div role="progressbar" style="width: {{productCount}}%" aria-valuenow="70" aria-valuemin="0"
                    aria-valuemax="100" class="progress-bar progress-bar-template dashbg-2"></div>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-sm-6">
              <div class="statistic-block block">
                <div class="progress-details d-flex align-items-end justify-content-between">
                  <div class="title">
                    <div class="icon"><i class="icon-paper-and-pencil"></i></div><strong>Total Orders</strong>
                  </div>
                  <div class="number dashtext-3">{{orderCount}}</div>
                </div>
                <div class="progress progress-template">
                  <div role="progressbar" style="width: {{orderCount}}%" aria-valuenow="55" aria-valuemin="0"
                    aria-valuemax="100" class="progress-bar progress-bar-template dashbg-3"></div>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-sm-6">
              <div class="statistic-block block">
                <div class="progress-details d-flex align-items-end justify-content-between">
                  <div class="title">
                    <div class="icon"><i class="icon-writing-whiteboard"></i></div><strong>Total Revenue</strong>
                  </div>
                  <div class="number dashtext-4">{{totalRevenue}}</div>
                </div>
                <div class="progress progress-template">
                  <div role="progressbar" style="width: {{orderStatusD.[0].count}}%" aria-valuenow="35"
                    aria-valuemin="0" aria-valuemax="100" class="progress-bar progress-bar-template dashbg-4"></div>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-6">
              <div class="top-products block">
                <div class="title"><strong>Best Selling Products</strong></div>
                <div class="products">
                  <ul>
                    {{#each product}}
                    <li>
                      <span>{{this._id}}</span>
                      <span>{{this.totalOrderValue}}</span>
                    </li>
                    {{/each}}
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="top-categories block">
                <div class="title"><strong>Best Selling Categories</strong></div>
                <div class="categories">
                  <ul>
                    
                    <li>
                      <span> Fruits </span><br>
                      <span> Vegitable</span><br>
                      <span>Bread</span>
                      
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      {{!--
      ----------------------------------------------------------------------------------------------------------------------------------------------------------------
      --}}
      <section class="no-padding-bottom">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-4">
              <div class="bar-chart block no-margin-bottom">
                <canvas id="year"></canvas>
              </div>
              <div class="bar-chart block no-margin-bottom">
                <canvas id="month"></canvas>
              </div>
            </div>

            <div class="col-lg-8">
              <div class="line-cahrt block">
                <canvas id="canvasId"></canvas>
                {{!-- <canvas id="barChartExample1"></canvas> --}}
                {{!-- <canvas id="barChartweek"></canvas>
                <canvas id="barChartmonth"></canvas>
                <canvas id="barChartyear"></canvas> --}}

                {{!-- <canvas id="lineCahrt"></canvas> --}}
                {{!-- <button onclick="Chart('day')">Day</button>
                <button onclick="Chart('month')">Month</button>
                <button onclick="Chart('year')">Year</button> --}}
              </div>

            </div>
          </div>
        </div>
      </section>

      <section class="no-padding-bottom">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-6">
              <div class="messages-block block">
                <div class="title"><strong>Order Status</strong></div>
                <div class="messages"><a href="#" class="message d-flex align-items-center">
                    <div class="profile"><img src="placed.png" alt="..." class="img-fluid">

                    </div>
                    <div class="content" style="display: flex;">
                      <strong class="d-block">Placed:</strong>
                      <span class="d-block ml-5">
                        {{orderStatusP.[0].count}}
                      </span>
                    </div>
                  </a><a href="#" class="message d-flex align-items-center">
                    <div class="profile"><img src="placed.png" alt="..." class="img-fluid">
                    </div>
                    <div class="content" style="display: flex;">
                      <strong class="d-block">Cancelled:</strong>
                      <span class="d-block ml-5">{{orderStatusC.[0].count}}</span>
                    </div>
                  </a><a href="#" class="message d-flex align-items-center">
                    <div class="profile"><img src="placed.png" alt="..." class="img-fluid">
                    </div>
                    <div class="content" style="display: flex;">
                      <strong class="d-block">Out for delivery:</strong>
                      <span class="d-block ml-5">{{orderStatusO.[0].count}}</span>
                    </div>
                  </a><a href="#" class="message d-flex align-items-center">
                    <div class="profile"><img src="placed.png" alt="..." class="img-fluid">

                    </div>
                    <div class="content" style="display: flex;">
                      <strong class="d-block">Delivered:</strong>
                      <span class="d-block ml-5">{{orderStatusD.[0].count}}</span>
                    </div>
                  </a><a href="#" class="message d-flex align-items-center">
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="messages-block block">
                <div class="title"><strong>Transaction</strong></div>
                <div class="messages">
                  <div class="profile"><img src="payment.jpg" alt="..." class="img-fluid">

                  </div>
                  <div class="content" style="display: flex;">
                    <strong class="d-block">COD Payment : </strong>
                    <span class="d-block ml-5">{{codPay}}</span>
                  </div>
                  </a><a href="#" class="message d-flex align-items-center">
                    
                    <div class="profile"><img src="payment.jpg" alt="..." class="img-fluid">
                    </div>
                    <div class="content" style="display: flex;">
                      <strong class="d-block">Online Payment : </strong>
                      <span class="d-block ml-5">{{online}}</span>
                    </div>
                  </a><a href="#" class="message d-flex align-items-center">

                    <div class="profile"><img src="payment.jpg" alt="..." class="img-fluid">
                  </div>
                  <div class="content" style="display: flex;">
                    <strong class="d-block">Wallet Payment : </strong>
                    <span class="d-block ml-5">{{wallet}}</span>
                  </div>
                  </a><a href="#" class="message d-flex align-items-center">
                    


                </div>
              </div>


            </div>



      </section>


      {{!-- <section class="no-padding-bottom">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-4">
              <div class="bar-chart block no-margin-bottom">
                <canvas id="barChartExample1"></canvas>
              </div>
            </div>
            <div class="col-lg-8">
              <div class="line-cahrt block">
                <canvas id="lineCahrt"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>



      <section class="no-padding-bottom">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-4">
              <div class="bar-chart block no-margin-bottom">
                <canvas id="barChartExample1"></canvas>
              </div>
            </div>
            <div class="col-lg-8">
              <div class="line-cahrt block">
                <canvas id="lineCahrt"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section> --}}


      {{!-- <div style="height: 30%; width: auto;">

      </div>
      <div style="display: flex;">
        <div style="margin-left: 10%;">
          <h4>Order Statistics</h4>

          <p style="">10</p>
        </div>
        <div style="margin-left: 10%;">
          <h4>Order Status</h4>

          <div class="status-container">
            <div class="status-item">
              <h6>Placed</h6>
              <h6>7</h6>
            </div>

            <div class="status-item">
              <h6>Shipped</h6>
              <h6>5</h6>
            </div>

            <div class="status-item">
              <h6>Delivered</h6>
              <h6>20</h6>
            </div>

            <div class="status-item">
              <h6>Cancel</h6>
              <h6>2</h6>
            </div>

            <div class="status-item">
              <h6>Return</h6>
              <h6>10</h6>
            </div>
          </div>
        </div>

        <div style="margin-left: 10%;">
          <h4>Transaction</h4>
        </div>
      </div> --}}


      {{> adminfooter}}
    </div>
  </div>


  <!-- JavaScript files-->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/popper.js/umd/popper.min.js"> </script>
  <script src="/vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="/vendor/jquery.cookie/jquery.cookie.js"> </script>
  <script src="/vendor/chart.js/Chart.min.js"></script>
  <script src="/vendor/jquery-validation/jquery.validate.min.js"></script>
  <script src="/js/charts-home.js"></script>
  <script src="/js/front.js"></script>



  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

  //pahe loadede chartjs
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      console.log('function called ');

      fetch('/admin/chart-data')
        .then(response => response.json())
        .then(data => {
          console.log(data);

          // Separate data for daily, monthly, and yearly charts
          const dailyData = data.filter(entry => entry._id.day !== undefined);
          const monthlyData = data.filter(entry => entry._id.month !== undefined);
          const yearlyData = data.filter(entry => entry._id.year !== undefined);

          // Process the data and create the Chart.js chart for Daily chart
          createChart('dailyChart', dailyData, 'Daily Orders', 'rgba(255, 99, 132, 0.2)', 'rgba(255, 99, 132, 1)');

          // Process the data and create the Chart.js chart for Monthly chart
          createChart('monthlyChart', monthlyData, 'Monthly Orders', 'rgba(75, 192, 192, 0.2)', 'rgba(75, 192, 192, 1)');

          // Process the data and create the Chart.js chart for Yearly chart
          createChart('yearlyChart', yearlyData, 'Yearly Orders', 'rgba(153, 102, 255, 0.2)', 'rgba(153, 102, 255, 1)');
        })
        .catch(error => console.error('Error fetching chart data:', error));

      function createChart(canvasId, chartData, label, backgroundColor, borderColor) {
        const labels = chartData.map(entry => {
          if (entry._id.day !== undefined) {
            return `${entry._id.year}-${entry._id.month}-${entry._id.day}`;
          } else if (entry._id.month !== undefined) {
            return `${entry._id.year}-${entry._id.month}`;
          } else if (entry._id.year !== undefined) {
            return entry._id.year.toString();
          }
        });

        const counts = chartData.map(entry => entry.count);

        const graph = document.getElementById('canvasId').getContext('2d');
        new Chart(graph, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: label,
              data: counts,
              backgroundColor: backgroundColor,
              borderColor: borderColor,
              borderWidth: 1
            }]
          }
        });
      }
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      console.log('function called ');

      fetch('/admin/chart-data-year')
        .then(response => response.json())
        .then(data => {
          console.log(data);

          // Separate data for daily, monthly, and yearly charts
          //const dailyData = data.filter(entry => entry._id.day !== undefined);
          //const monthlyData = data.filter(entry => entry._id.month !== undefined);
          const yearlyData = data.filter(entry => entry._id.year !== undefined);

          // Process the data and create the Chart.js chart for Daily chart
          //createChart('dailyChart', dailyData, 'Daily Orders', 'rgba(255, 99, 132, 0.2)', 'rgba(255, 99, 132, 1)');

          // Process the data and create the Chart.js chart for Monthly chart
          //createChart('monthlyChart', monthlyData, 'Monthly Orders', 'rgba(75, 192, 192, 0.2)', 'rgba(75, 192, 192, 1)');

          // Process the data and create the Chart.js chart for Yearly chart
          createChart('yearlyChart', yearlyData, 'Yearly Orders', 'rgba(153, 102, 255, 0.2)', 'rgba(153, 102, 255, 1)');
        })
        .catch(error => console.error('Error fetching chart data:', error));

      function createChart(canvasId, chartData, label, backgroundColor, borderColor) {
        const labels = chartData.map(entry => {
          return entry._id.year.toString();
        });

        const counts = chartData.map(entry => entry.count);

        const graph = document.getElementById('year').getContext('2d');
        new Chart(graph, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: label,
              data: counts,
              backgroundColor: backgroundColor,
              borderColor: borderColor,
              borderWidth: 1
            }]
          }
        });
      }
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      console.log('function called ');

      fetch('/admin/chart-data-month')
        .then(response => response.json())
        .then(data => {
          console.log(data);

          // Separate data for daily, monthly, and yearly charts
          //const dailyData = data.filter(entry => entry._id.day !== undefined);
          const monthlyData = data.filter(entry => entry._id.month !== undefined);
          //const yearlyData = data.filter(entry => entry._id.year !== undefined);

          // Process the data and create the Chart.js chart for Daily chart
          //createChart('dailyChart', dailyData, 'Daily Orders', 'rgba(255, 99, 132, 0.2)', 'rgba(255, 99, 132, 1)');

          // Process the data and create the Chart.js chart for Monthly chart
          createChart('monthlyChart', monthlyData, 'Monthly Orders', 'rgba(75, 192, 192, 0.2)', 'rgba(75, 192, 192, 1)');

          // Process the data and create the Chart.js chart for Yearly chart
          //createChart('yearlyChart', yearlyData, 'Yearly Orders', 'rgba(153, 102, 255, 0.2)', 'rgba(153, 102, 255, 1)');
        })
        .catch(error => console.error('Error fetching chart data:', error));

      function createChart(canvasId, chartData, label, backgroundColor, borderColor) {
        const labels = chartData.map(entry => {
          return `${entry._id.year}-${entry._id.month}`;
        });

        const counts = chartData.map(entry => entry.count);

        const graph = document.getElementById('month').getContext('2d');
        new Chart(graph, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: label,
              data: counts,
              backgroundColor: backgroundColor,
              borderColor: borderColor,
              borderWidth: 1
            }]
          }
        });
      }
    });
  </script>

</body>

</html>